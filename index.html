<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style type="text/css">
    div#gnav{
        /*width: 270px;
        margin: 0 auto;*/
        height: 30px;
        text-align: center; /*è¿™ä¸ªæ¯”ä¸Šé¢çš„ç”¨æ³•å¥½ç”¨ æ€ä¹ˆå¿˜äº†*/
    }
    #mine_total{
        width: 30px;
        text-align: center;
    }
    </style>
    <title>æ‰«é›·</title>
</head>
<body>
    <div id="container">
    <div id="gnav">
        å‰©ä½™:<input type="text" id="mine_total" value="0">
        <input type="radio" name="level" id="lv-1" checked="checked" onchange="g_init(0)">
        <!-- è¿™é‡Œç”¨onchangeè€Œä¸ç”¨onclickæ˜¯å› ä¸ºonchangeç‚¹å‡»æ–‡å­— labelä¹Ÿä¼šå“åº” è€Œonclickåªå“åº”æŒ‰é’® -->
        <label for="lv-1">åˆçº§</label>
        <input type="radio" name="level" id="lv-2"  onchange="g_init(1)">
        <label for="lv-2">ä¸­çº§</label>
        <input type="radio" name="level" id="lv-3" onchange="g_init(2)">
        <label for="lv-3">ç»ˆæ</label>
        <button id="btn" onclick="g_init()">é‡æ–°å¼€å§‹</button>
        <!-- é‡æ–°å¼€å§‹è®¾ç½®ä¸ºç©º -->
    </div>
    </div>
    <canvas id="mycanv" height="800" width="800"></canvas>
    <script>
        // @type{HTMLCanvasElement}è·å–ç»˜ç”»ç¯å¢ƒ
    var canv=document.getElementById("mycanv");
    var ctx=canv.getContext('2d');
    var gnav=document.getElementById('gnav');
    var mine_total=document.getElementById('mine_total');

    //åˆå§‹åŒ–æ¸¸æˆä¿¡æ¯å˜é‡
    var levels=[[9,9,10],[16,16,25],[16,25,40]];
    var level=levels[0];//9è¡Œ9åˆ—10é›· levels=[[9,9,10]åˆçº§,[16,16,25]ä¸­çº§,[16,25,40]ç»ˆæ]
    var g_arr=[];//è®°å½•æ¯ä¸€å—çš„åæ ‡ä¿¡æ¯ ä¾‹å¦‚1-3 4-9
    var g_obj={};//æ­¤å¯¹è±¡ä»¥åæ ‡ä¸ºå¥ å±æ€§æœ‰æ ‡è¯†ï¼Œæ‰“å¼€çŠ¶æ€ æ ‡æ³¨çŠ¶æ€...
    var g_color={block:'skyblue',open:'#bbb',mine:'#69d',bomb:'#a00',highlight:'#89f'}//é¢œè‰²è®¾ç½® å—é¢œè‰² æ‰“å¼€çŠ¶æ€é¢œè‰² é›·å—é¢œè‰²
    var mine=['ğŸ’£','ğŸš©','â“','ğŸ’¥']
    
    var mine_arr=[];//å®šä¹‰é›·çš„æ•°ç»„ ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ‰«é›·æˆåŠŸ
    var count=0;
    var gameover=false;//æ¸¸æˆå¤±è´¥ æ‰€æœ‰åŠŸèƒ½å¤±æ•ˆ
    var timer=0;//è®¡æ—¶

    g_init(0);

    function g_init(n){
       level=n==undefined?level:levels[n]; //level=(n==undefined?level:levels[n]); å¦‚æœç‚¹å‡»é‡æ–°å¼€å§‹ næ˜¯æœªå®šä¹‰åˆ™æ˜¾ç¤ºåŸæ¥çš„level
       //æ¯æ¬¡æ”¹å˜ç­‰çº§ é‡ç½®å˜é‡
       g_arr=[];//æŠŠä¹‹å‰çš„æ¸…ç©º
       mine_arr=[];//éšæœºå¸ƒçš„é›·æ¸…ç©º
       count=0;//è®¡æ•°é‡ç½®
       gameover=false;
       timer=0;
       //ç”»å¸ƒæ”¹å˜å®½åº¦é«˜åº¦
       canv.width=level[1]*50;
       canv.height=level[0]*50;
       ctx.clearRect(0,0,level[1]*50,level[0]*50)//é‡ç½®ç”»å¸ƒ level[1]åˆ—*50=é•¿ level[0]*50=å®½
       mine_total.value=level[2];
       gnav.style.width=level[1]*50+'px';
       /*var container=document.getElementById("container"); gnavå±…ä¸­
       container.style.width=level[1]*50+'px';*/
       //ä½¿ç”¨forå¾ªç¯éå† å¸ƒå±€
    for(let i=0;i<level[0];i++){//9è¡Œ
        for(let j=0;j<level[1];j++){//9åˆ—
          let xy=j+"-"+i;//è¿™è¾¹ä½¿ç”¨j-iæ˜¯å› ä¸ºé¡ºåºæ˜¯0-0 1-0 2-0....6-8 7-8 8-8 å…ˆæŒ‰è¡Œå¸ƒå±€
          g_arr.push(xy);//æ·»åŠ åæ ‡ä¿¡æ¯
          g_obj[xy]={mark:0,open:0};//markæ˜¯æ ‡è¯† -1ä¸ºé›· 0-8æ˜¯æ•°å­—å— openæ˜¯æ‰“å¼€çŠ¶æ€  0æœªæ‰“å¼€ 1å·²æ‰“å¼€ -1æ ‡æ³¨ä¸ºé›·å— 2ä¸ºç–‘ä¼¼é›·å— å…¨éƒ¨åˆå§‹åŒ–
          //åˆå§‹åŒ–å¸ƒå±€ï¼šç»˜åˆ¶æ¸¸æˆå—
          drawBlock(xy,g_color.block);
        }
      }
      setMine();
    }

    //éšæœºå¸ƒé›·å°è£…å‡½æ•°
    function setMine(){
        //sort()æ–¹æ³•å¯ä»¥å®ç°å‡åºé™åºå’Œéšæœºæ’åˆ— åœ¨è¿™æ­¤å‚æ•°æ˜¯ç”¨ç®­å¤´å‡½æ•°å®šä¹‰ä¸€ä¸ªéšæœºæ’åˆ—å‡½æ•° sliceå¯ä»¥æˆªå–æ•°ç»„é•¿åº¦ç‰‡æ®µ
        mine_arr=g_arr.sort(()=>Math.random()-0.5).slice(0,level[2]);
        //å¯¹æ¯ä¸ªå—è¿›è¡Œéå†è®¾ç½®å¯¹è±¡çš„ä¿¡æ¯
        mine_arr.forEach(n=>{
            g_obj[n].mark=-1;
            let around=getAround(n)
            around.forEach(xy=>{
             if(g_obj[xy].mark!=-1) //*å¾ˆé‡è¦ ä¸èƒ½è¦†ç›–æœ‰é›·çš„æ ‡è¯†  æ¯”å¦‚ä¸¤ä¸ªé›·å‘¨è¾¹åŒºåŸŸé‡å (é ä¸€èµ·äº†) æ ‡è¯†ä¼šè¢«è¦†ç›–
              g_obj[xy].mark++   //æœ‰é›·å‘¨å›´å…¨éƒ¨+1
            })
        })
    }
    //showInfo();//ç¡®è®¤å¸ƒå±€æ— è¯¯å å…³é—­ä½œå¼Šå™¨
    //è¾…åŠ©æ˜¾ç¤º å°†æ ‡è¯†æ˜¾ç¤ºåœ¨å¯¹åº”çš„å—ä¸Šç”¨äºéªŒè¯
    function showInfo(){
        //å¯¹æ‰€æœ‰çš„å…ƒç´ è¿›è¡Œéå† å¦‚æœmark=-1 æ ‡è¯†ä¸ºé›·å— å¦åˆ™æ˜¾ç¤ºæ–‡æœ¬
       g_arr.forEach(n=>{
           if(g_obj[n].mark==-1){
               drawBlock(n,g_color.mine);
               markText(n,mine[0]);
           }else{
               markText(n,g_obj[n].mark);
           }
       })
    }
    //æ˜¾ç¤ºæ–‡æœ¬
    function markText(xy,txt){
        let[x,y]=xy.split('-').map(n=>n*50);
        ctx.save()
        ctx.font='15px Arial'
        ctx.fillStyle='darkblue'
        ctx.textAlign='center'
        ctx.textBaseline='middle' //è®¾ç½®ä¸Šä¸‹å¯¹é½
        ctx.fillText(txt,x+25,y+25)
        ctx.restore()
    }
    //è·å–å‘¨è¾¹
    function getAround(xy){
      let[x,y]=xy.split('-').map(n=>n*1); //è¿™é‡Œéå†âœ–ï¸1æ˜¯å› ä¸ºxyæ˜¯å­—ç¬¦ä¸² åˆ†å‰²å‡ºæ¥è¿˜æ˜¯å­—ç¬¦ä¸² è¦å°†å…¶è½¬æ¢ä¸ºæ•°å­— å¦åˆ™åæœŸå¦‚æœç”¨+è¿ç®—ç¬¦è¿›è¡Œç›¸åº”çš„è¿ç®— ä¼šè¿›è¡Œæ‹¼ä¸² è¿™æ˜¯+è¿ç®—ç¬¦çš„ç‰¹æ®Šæ€§å¯¼è‡´çš„
      let around=[];
      for(let i=-1;i<=1;i++){ //æ§åˆ¶è¯¥ç‚¹åŠ å…¶ä¸Šä¸‹3è¡Œ
        for(let j=-1;j<=1;j++){//æ§åˆ¶è¯¥ç‚¹åŠ å…¶å·¦å³3åˆ—
            let id=`${x+j}-${y+i}` //å­—ç¬¦æ¨¡ç‰ˆ 
            //åˆ¤æ–­å¾—åˆ°åæ ‡æ˜¯å¦åœ¨arr[]æ•°ç»„ä¸­ ä¾‹å¦‚0-0ä¼šå¾—åˆ°-1 - -1 è¿™äº›éƒ½ä¸åœ¨arr[]æ•°ç»„ä¸­
            //å¦‚æœåœ¨ åˆ™å°†æœ‰æ•ˆçš„åœ°å€åŠ åˆ°å…¶è¯¥ç‚¹around[]æ•°ç»„ä¸­ around[]æ•°ç»„ä¸­çš„å…ƒç´ å°±æ˜¯è¯¥ç‚¹çš„å‘¨å›´å…ƒç´ 
            if(g_arr.includes(id)&&id!=xy)around.push(id);//èˆå»è‡ªå·± èˆå·±
        }
      }
      /*ä¾‹å¦‚2-2 åˆ™å…¶å‘¨å›´
      1-1 1-2 1-3
      2-1 2-2 2-3
      3-1 3-2 3-3
      */
    return around;
    }


    //ç»˜åˆ¶åœ†è§’çŸ©å½¢å°è£…å‡½æ•°
    function drawBlock(xy,c){ //xyæ˜¯åæ ‡å‚æ•° cæ˜¯é¢œè‰²
        let w=50,r=6,m=2;//width,radius,margin
        let [x,y]=xy.split('-').map(n=>n*w)//ç”¨mapéå†å°†æ¯ä¸€ä¸ªå—éƒ½ä¹˜ä»¥ä¸€ä¸ªå®½åº¦ [x,y]çš„å«ä¹‰ç”±ç´¢å¼•ä½ç½®å˜ä¸ºå®é™…åæ ‡ eg[1,1]->[50,50]   //splitå°†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²ä¸ºå­å­—ç¬¦ä¸²ï¼Œç„¶åå°†ç»“æœä½œä¸ºå­—ç¬¦ä¸²æ•°ç»„è¿”å› è¿™é‡Œçš„æ„æ€æ˜¯ç”¨x-yä¸­çš„-å°†x-yåˆ†å‰²ä¸º[x,y]
        ctx.save();
        ctx.beginPath();
        ctx.moveTo(x,y+r)//å› ä¸ºæœ‰åœ†è§’ ä¸èƒ½ç§»åˆ°é¡¶ç‚¹
        //arcTo(x1,y1,x2,y2,r) ç»˜åˆ¶ä»‹äºä¸¤ä¸ªåˆ‡çº¿ä¹‹é—´çš„åœ†å¼§,åæ ‡ç‚¹(x1,y1)ä¸ºåœ†å¼§èµ·ç‚¹åæ ‡,(x2,y2)ä¸ºåœ†å¼§ç»ˆç‚¹åæ ‡,rä¸ºåœ†å¼§åŠå¾„
        ctx.arcTo(x,y+w-m,x+w-m,y+w-m,r)//åŠ wå°±æ˜¯å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå—çš„è·ç¦» -mæ˜¯ç•™å—ä¹‹é—´çš„é—´éš™   ç»˜åˆ¶ç¬¬ä¸€ä¸ªåœ†è§’
        ctx.arcTo(x+w-m,y+w-m,x+w-m,y,r)//ç¬¬äºŒä¸ªåœ†è§’
        ctx.arcTo(x+w-m,y,x,y,r)//ç¬¬ä¸‰ä¸ªåœ†è§’
        ctx.arcTo(x,y,x,y+w-m,r)//ç¬¬å››ä¸ªåœ†è§’
        ctx.fillStyle=c//å¡«å……é¢œè‰²
        ctx.fill()
        ctx.restore()//æ¢å¤ä¸Šä¸€ä¸ªåœºæ™¯
    }
    //é¼ æ ‡äº‹ä»¶ï¼šç®€å•å®ç°æ‰«é›·:click contentmenu é¼ æ ‡å·¦é”®ä¸å³é”®
    canv.addEventListener('click',openBlock)//æ·»åŠ ç›‘å¬äº‹ä»¶
    canv.addEventListener('contextmenu',markMine)//é¼ æ ‡å³é”®æ ‡æ³¨
    function openBlock(ev){
        if(gameover){
            return;
        }
        if(timer==0){
            timer=new Date();
        }
        let x=~~(ev.offsetX/50);//~~()å¿«é€Ÿå–æ•´æ–¹æ³• ï¼ˆå°†å†…å®¹è½¬åŒ–ä¸ºæ•°å­—ï¼Œæˆ–è€…å°æ•°å–æ•´ï¼‰
        let y=~~(ev.offsetY/50);
        let xy=x+'-'+y;
        //console.log(x,y);
        //æ‰“å¼€æ¸¸æˆå—ï¼š 1æ›´æ–°æ¸¸æˆæ•°æ® openå˜ä¸º1   2æ›´æ–°é¡µé¢ 
        if(g_obj[xy].open!=0)return 0;//å¦‚æœçŠ¶æ€æ˜¯å·²æ‰“å¼€çš„ ç›´æ¥è¿”å›  0æœªæ‰“å¼€ 1å·²æ‰“å¼€ -1æ ‡æ³¨ä¸ºé›·å— 2ä¸ºç–‘ä¼¼é›·å— 
        g_obj[xy].open=1;
        drawBlock(xy,g_color.open);
        markText(xy,g_obj[xy].mark);
        if(g_obj[xy].mark==0){
            //é€’å½’æ¸…é›¶ å‘¨å›´å…¨éƒ¨æ˜¾ç¤º
            openZero(xy);
        }else if(g_obj[xy].mark==-1){
            //è§¦é›·ï¼Œæ¸¸æˆæå‰ç»“æŸ
            drawBlock(xy,g_color.bomb);
            markText(xy,mine[0]);
            markText(xy,mine[3]);
            checkOver();
        }
    }
    function openZero(xy){
        let around=getAround(xy);
        around.forEach(n=>{
            if(g_obj[n].open==0){  //opençŠ¶æ€å…¨éƒ¨ç”±0è½¬ä¸º1
             g_obj[n].open=1;
             drawBlock(n,g_color.open);
             markText(n,g_obj[n].mark);
             //å¦‚æœç¢°åˆ°çš„åˆé‡è§0 ç»§ç»­æ‰“å¼€ å³é€’å½’
             if(g_obj[n].mark==0){
                 openZero(n);
             }
            }
        })
    }

    function markMine(ev){
        //æ ‡æ³¨é›·å—ï¼šå¯¹æœªæ‰“å¼€çš„å—ï¼Œæ ‡æ³¨é›·å—-1ï¼Œæ ‡æ³¨ç–‘ä¼¼é›·å—2ï¼Œå–æ¶ˆæ ‡æ³¨0
        if(gameover)return;
        if(timer==0){
            timer=new Date();
        }
        ev.preventDefault();//é˜»æ­¢æµè§ˆå™¨å³å‡»é»˜è®¤è¡Œä¸º
        let x=~~(ev.offsetX/50);
        let y=~~(ev.offsetY/50);
        let xy=x+'-'+y;
        //æ›´æ–°æ•°æ®ï¼Œæ›´æ–°é¡µé¢
        if(g_obj[xy].open==1)return;//å¦‚æœæ˜¯å·²æ‰“å¼€çš„ï¼Œç›´æ¥è¿”å› ä¸æ‰§è¡Œ  å³å·²æ‰“å¼€çš„å—é¼ æ ‡å³å‡»æ— æ•ˆ
        if(g_obj[xy].open==0){  // åˆ¤æ–­ æœªæ‰“å¼€çš„å—æ‰å¯ä»¥æ ‡æ³¨
        g_obj[xy].open=-1;//æ ‡æ³¨ä¸ºç‚¸å¼¹
        drawBlock(xy,g_color.mine);
        markText(xy,mine[1]);
        count++;
        mine_total.value=level[2]-count;//æ ‡æ³¨æ—¶å‰©ä½™é›·å—å‡å»
        if(count==level[2])checkOver();//å¦‚æœæ ‡æ³¨é›·æ•°ç­‰äºå½“å‰ç­‰çº§é›·æ•° æ¸¸æˆç»“æŸ
       }else if(g_obj[xy].open==-1){ //å°†æ ‡è®°ä¸ºç‚¸å¼¹çš„å—å˜ä¸ºç–‘ä¼¼é›·å— ä¹Ÿå°±æ˜¯ç¬¬äºŒæ¬¡å³å‡»
         g_obj[xy].open=2;
         drawBlock(xy,g_color.mine);
         markText(xy,mine[2]);
         count--;
         mine_total.value=level[2]-count;//å–æ¶ˆæ ‡æ³¨æ—¶å†é‡æ–°è®¡ç®—
       }else if(g_obj[xy].open=2){//å¯¹ç–‘ä¼¼é›·å—å³å‡»ï¼Œä½¿å…¶æ¢å¤æœªæ‰“å¼€çŠ¶æ€
          g_obj[xy].open=0;
         drawBlock(xy,g_color.block); 
       }
      }

      //æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
      function checkOver(){
        gameover=true;
        let timer2=new Date();
        let durtime=((timer2-timer)/1000).toFixed(2);//é™¤1000è½¬æ¢ä¸ºç§’ toFixed(2)ä¿ç•™ä¸¤ä½å°æ•°
        let win=mine_arr.every(n=>g_obj[n].mark==g_obj[n].open)//å½“æ ‡æ³¨é›·æ•°å°äºå®é™…é›·æ•°æ—¶ æ ‡æ³¨é”™è¯¯ä¹Ÿä¸ä¼šæŠ¥é”™ åªæœ‰æ ‡æ³¨é›·æ•°=å®é™…é›·æ•°æ—¶ æ‰ä¼šåˆ¤æ–­æ¸¸æˆç»“æœ everyè¿”å›true or false
        //åªæœ‰mark=-1 open=-1 æ‰ç®—æ ‡æ³¨æˆåŠŸ
            setTimeout(()=>{
                let next=confirm(win?"Congratulations!\n take your time:"+durtime+'ç§’ once again?':'good gameï¼once againï¼Ÿ'); //è¿™é‡Œç”¨æ³•å¾ˆå¥½  å­—ç¬¦ä¸²æ‹¼æ¥ï¼ç”¨æ³• 
                //ç‚¹ç¡®å®šç›´æ¥é‡æ–°å¼€å§‹ å–æ¶ˆåˆ™åœç•™å½“å‰é¡µé¢
                if(next)g_init();
            },500);
      }
      //è¾…åŠ©æ‰«é›·: mousedown,mouseup ä¸ç”¨onmouseup,onmousedownåŸå› æ˜¯å…¶åªèƒ½ç»‘å®šä¸€ä¸ªå“åº”äº‹ä»¶
      //1.æŒ‰ä¸‹é¼ æ ‡ï¼Œé«˜äº®å‘¨è¾¹ï¼Œæ¾å¼€é¼ æ ‡ï¼Œå–æ¶ˆé«˜äº®
      //2.è¾…åŠ©æ‰«é›·ï¼Œå¯¹äºæ˜ç¡®çš„é›·å—æˆ–å®‰å…¨å—è¿›è¡Œæ ‡æ³¨æˆ–æ‰“å¼€
      canv.addEventListener('mousedown',highlight);
      canv.addEventListener('mouseup',highlight);//ä¸æ•´åˆç”¨unhighlight
      canv.addEventListener('mouseup',supGame);//ç”¨mouseupå°±å¯ä»¥æ·»åŠ äº‹ä»¶ç›‘å¬çš„å¤šä¸ªäº‹ä»¶
      function highlight(ev){
          if(gameover)return;
          let x=~~(ev.offsetX/50);
          let y=~~(ev.offsetY/50);
          let xy=x+'-'+y;
          if(g_obj[xy].open!=1)return;//å¦‚æœéæ‰“å¼€çŠ¶æ€ ç›´æ¥è¿”å› é«˜äº®å¤±æ•ˆ
    //æ•´åˆä»£ç 
          let color=ev.type=='mousedown'?g_color.highlight:g_color.block
          getAround(xy).forEach(n=>{
              if(g_obj[n].open==0){  //å¦‚æœè¢«ç‚¹å‡»å…ƒç´ å‘¨å›´çš„å…ƒç´ æ˜¯æœªæ‰“å¼€çŠ¶æ€ ä¼šé«˜äº®æ˜¾ç¤º
                  drawBlock(n,color)  //ä¸æ•´åˆæ˜¯drawBlock(n,g_obj.highlight)
              }
          })
        }
        /* æ•´åˆ
        function unhighlight(ev){
          let x=~~(ev.offsetX/50);
          let y=~~(ev.offsetY/50);
          let xy=x+'-'+y;
          if(g_obj[xy].open!=1)return;
          getAround(xy).forEach(n=>{
              if(g_obj[n].open==0){  
                  drawBlock(n,g_color.block) //æ¢å¤åŸæ¥æ ·å¼
              }
          })
        }
       */
        function supGame(ev){
        if(gameover)return;
        let x=~~(ev.offsetX/50);
        let y=~~(ev.offsetY/50);
        let xy=x+'-'+y;
        if(g_obj[xy].open!=1)return; //å¦‚æœé‡åˆ°0æœªæ‰“å¼€  -1æ ‡æ³¨ä¸ºé›·å— 2ä¸ºç–‘ä¼¼é›·å— åˆ™æ— æ•ˆ
        let mark=g_obj[xy].mark;  //markå®é™…æ ‡è¯†  0-8ä¸ºå‘¨å›´é›·æ•° 
        let marked_mine=0;
        let unopen=0;
        let around=getAround(xy);
        around.forEach(n=>{
            if(g_obj[n].open==-1)marked_mine++;//å·²æ ‡æ³¨ä¸ºé›·çš„ æ ‡è®°é›·++
            if(g_obj[n].open==0)unopen++;//æœªæ‰“å¼€çš„ unopen++
        })
        around.forEach(n=>{
            if(g_obj[n].open==0)//é¦–å…ˆç¡®ä¿æ˜¯æœªæ‰“å¼€çš„
            {
                if(mark==marked_mine)//å·²ç»å…¨éƒ¨æ ‡æ³¨å®Œçš„
                {   g_obj[n].open=1;//è®¾ç½®å…¶ä¸ºæ‰“å¼€çŠ¶æ€
                    drawBlock(n,g_color.open);
                    markText(n,g_obj[n].mark);
                    if(g_obj[n].mark==0)openZero(n);
                      //é‡åˆ°0ä¹Ÿè¦é€’å½’æ¸…é›¶
                    if(g_obj[n].mark==-1){ // å¦‚æœæ ‡æ³¨é”™è¯¯ å°±æ˜¯æŠŠä¸è¯¥æ˜¯é›·çš„æ ‡æ³¨æˆé›· æ˜¯é›·çš„æœªæ ‡æ³¨æˆé›· è¿›è¡Œè¾…åŠ©æ‰«é›· ä¼šç›´æ¥ç‚¹çˆ†é›· é‡åˆ°é›·åˆ™æ¸¸æˆç»“æŸ
                        drawBlock(n,g_color.bomb);
                        markText(n,mine[0]);
                        markText(n,mine[3]);
                        checkOver();
                    }
                }else if((mark-marked_mine)==unopen){
                        g_obj[n].open=-1;
                        drawBlock(n,g_obj.mine);
                        markText(n,mine[1]);
                        count++;//æ ‡æ³¨ä¸ºé›· count++
                        mine_total.value=level[2]-count;
                        if(count==level[2])checkOver();
                    }
                }
            
        })

    }
    </script>
    
</body>
</html>